name: Build a ephemeral helm chart
branding:
  icon: 'package'
  color: 'orange'
inputs:
  artifact_name:
    description: 'The base name of the helm chart, defaults to repository name.'
    required: false
    default: '${{ github.event.repository.name }}'
  helm_repo_url:
    description: 'The helm repository url'
    required: true
  helm_repo_username:
    description: 'The helm repository username'
    required: true
  helm_repo_password:
    description: 'The helm repository password'
    required: true
outputs:
  eph_docker_tag:
    description: 'The ephemeral docker tag'
  eph_helm_app_version:
    description: 'The helm application version'
  eph_helm_chart_version:
    description: 'The helm chart version'
  eph_uploaded_file:
    description: 'The url of the uploaded artifact'
runs:
  using: docker
  image: Dockerfile
  env:
    ARTIFACT_NAME: ${{ inputs.artifact_name }}
    REPO_URL: ${{ inputs.helm_repo_url }}
    REPO_USER: ${{ inputs.helm_repo_username }}
    REPO_PASS: ${{ inputs.helm_repo_password }}